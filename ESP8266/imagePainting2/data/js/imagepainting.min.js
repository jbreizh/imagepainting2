window.fn={},window.fn.open=function(){document.getElementById("menu").open()},window.fn.load=function(e){var t=document.getElementById("content"),n=document.getElementById("menu");t.load(e).then(n.close.bind(n))},document.addEventListener("init",(function(e){var t="",n={},d={},l={},o={};function c(e,t){null!=document.getElementById("textStatus")&&(document.getElementById("textStatus").innerHTML=e),null!=document.getElementById("textStatus")&&(document.getElementById("textStatus").style.color=t),null!=document.getElementById("iconStatus")&&"red"==t&&document.getElementById("iconStatus").setAttribute("icon","myStatusRed"),null!=document.getElementById("iconStatus")&&"orange"==t&&document.getElementById("iconStatus").setAttribute("icon","myStatusOrange"),null!=document.getElementById("iconStatus")&&"green"==t&&document.getElementById("iconStatus").setAttribute("icon","myStatusGreen")}function u(e,t){e.checked?t.disabled=!0:t.disabled=!1}function i(e,t){var n=/(?:\.([^.]+))?$/.exec(e)[1],d=e.substring(0,e.length-(n.length+1));return d.length>20&&(d=d.substring(0,20)),""==t?d+"."+n:d+"."+t}function m(e,t){c("DOWNLOAD SUCCESS","green");var n=document.createElement("a");n.href=e,n.download=t,n.click()}function r(e,n){if(e.size>o.freeBytes)c("UPLOAD ERROR : NOT ENOUGH SPACE","red");else{var d=new FormData;d.append("file",e,n),function(e){var n=new XMLHttpRequest;n.onload=function(){200==this.status?c(this.responseText,"green"):c("UPLOAD ERROR : UPLOAD FAILED","red"),B(),I()},n.upload.onprogress=function(e){c("UPLOAD PROGRESS :"+Math.floor(e.loaded/e.total*100)+"%","orange")},n.onerror=function(){c("UPLOAD ERROR : CONNECTION LOST","red")},n.open("POST",t+"/upload",!0),n.send(e)}(d)}}function a(e){var n=new XMLHttpRequest;n.onload=function(){200==this.status?c(this.responseText,"green"):c(this.responseText,"red")},n.onerror=function(){c("ACTION ERROR : CONNECTION LOST","red")},n.open("GET",t+e,!0),n.send(null)}function s(){var e=new XMLHttpRequest;e.onload=function(){200==this.status&&function(e){d=JSON.parse(e),null!=document.getElementById("selectAction")&&(document.getElementById("selectAction").value=d.bmpPath);null!=document.getElementById("sliderActionStart")&&(document.getElementById("sliderActionStart").setAttribute("min",d.indexMin),document.getElementById("sliderActionStart").setAttribute("max",d.indexMax),document.getElementById("sliderActionStart").value=d.indexStart,document.getElementById("sliderActionStart").disabled=!d.isbmpload);null!=document.getElementById("textActionStart")&&(document.getElementById("textActionStart").innerHTML=d.indexStart+"px");null!=document.getElementById("sliderActionStop")&&(document.getElementById("sliderActionStop").setAttribute("min",d.indexMin),document.getElementById("sliderActionStop").setAttribute("max",d.indexMax),document.getElementById("sliderActionStop").value=d.indexStop,document.getElementById("sliderActionStop").disabled=!d.isbmpload);null!=document.getElementById("textActionStop")&&(document.getElementById("textActionStop").innerHTML=d.indexStop+"px");null!=document.getElementById("sliderActionLength")&&(document.getElementById("sliderActionLength").setAttribute("max",255*(d.indexStop-d.indexStart)),document.getElementById("sliderActionLength").value=(d.indexStop-d.indexStart)*l.delay);null!=document.getElementById("sliderActionLength")&&(document.getElementById("sliderActionLength").disabled=!d.isbmpload);null!=document.getElementById("textActionLength")&&(document.getElementById("textActionLength").innerHTML=(d.indexStop-d.indexStart)*l.delay+"ms");null!=document.getElementById("btnActionBurn")&&(document.getElementById("btnActionBurn").disabled=!d.isbmpload);null!=document.getElementById("btnActionPlay")&&(document.getElementById("btnActionPlay").disabled=!d.isbmpload);d.isbmpload?v.src=t+"/"+d.bmpPath:null!=document.getElementById("canvasAction")&&drawError("Not Load",document.getElementById("canvasAction"))}(this.responseText)},e.onerror=function(){c("BITMAP READ ERROR : CONNECTION LOST","red")},e.overrideMimeType("application/json"),e.open("GET",t+"/bitmapRead",!0),e.send(null)}function E(){var e=new XMLHttpRequest;e.onload=function(){200==this.status?c(this.responseText,"green"):c(this.responseText,"red"),s()},e.onerror=function(){c("BITMAP WRITE ERROR : CONNECTION LOST","red")},e.open("POST",t+"/bitmapWrite",!0),e.setRequestHeader("Content-type","application/json"),e.send(function(){null!=document.getElementById("sliderActionStart")&&(d.indexStart=document.getElementById("sliderActionStart").value);null!=document.getElementById("sliderActionStop")&&(d.indexStop=document.getElementById("sliderActionStop").value);null!=document.getElementById("selectAction")&&(d.bmpPath=document.getElementById("selectAction").value);return JSON.stringify(d)}())}function g(){var e=new XMLHttpRequest;e.onload=function(){200==this.status&&function(e){l=JSON.parse(e),null!=document.getElementById("sliderActionLength")&&(document.getElementById("sliderActionLength").value=(d.indexStop-d.indexStart)*l.delay);null!=document.getElementById("textActionLength")&&(document.getElementById("textActionLength").innerHTML=(d.indexStop-d.indexStart)*l.delay+"ms");null!=document.getElementById("sliderDelay")&&(document.getElementById("sliderDelay").value=l.delay);null!=document.getElementById("textDelay")&&(document.getElementById("textDelay").innerHTML=l.delay+"ms");null!=document.getElementById("sliderBrightness")&&(document.getElementById("sliderBrightness").value=l.brightness);null!=document.getElementById("textBrightness")&&(document.getElementById("textBrightness").innerHTML=l.brightness+"%");null!=document.getElementById("sliderCountdown")&&(document.getElementById("sliderCountdown").value=l.countdown);null!=document.getElementById("textCountdown")&&(document.getElementById("textCountdown").innerHTML=l.countdown+"ms");null!=document.getElementById("ckCountdown")&&(document.getElementById("ckCountdown").checked=l.iscountdown);null!=document.getElementById("sliderRepeat")&&(document.getElementById("sliderRepeat").value=l.repeat);null!=document.getElementById("textRepeat")&&(document.getElementById("textRepeat").innerHTML=l.repeat+"x");null!=document.getElementById("ckInvert")&&(document.getElementById("ckInvert").checked=l.isinvert);null!=document.getElementById("ckRepeat")&&(document.getElementById("ckRepeat").checked=l.isrepeat);null!=document.getElementById("ckBounce")&&(document.getElementById("ckBounce").checked=l.isbounce);null!=document.getElementById("ckRepeat")&&null!=document.getElementById("ckBounce")&&u(document.getElementById("ckRepeat"),document.getElementById("ckBounce"));null!=document.getElementById("ckBounce")&&null!=document.getElementById("ckRepeat")&&u(document.getElementById("ckBounce"),document.getElementById("ckRepeat"));null!=document.getElementById("sliderVcut")&&(document.getElementById("sliderVcut").value=l.vcut);null!=document.getElementById("textVcut")&&(document.getElementById("textVcut").innerHTML=l.vcut+"px");null!=document.getElementById("ckVcutOff")&&(document.getElementById("ckVcutOff").checked=l.isvcutoff);null!=document.getElementById("ckVcutColor")&&(document.getElementById("ckVcutColor").checked=l.isvcutcolor);null!=document.getElementById("ckVcutOff")&&null!=document.getElementById("ckVcutColor")&&u(document.getElementById("ckVcutOff"),document.getElementById("ckVcutColor"));null!=document.getElementById("ckVcutColor")&&null!=document.getElementById("ckVcutOff")&&u(document.getElementById("ckVcutColor"),document.getElementById("ckVcutOff"));null!=document.getElementById("sliderHcut")&&(document.getElementById("sliderHcut").value=l.hcut);null!=document.getElementById("textHcut")&&(document.getElementById("textHcut").innerHTML=l.hcut+"px");null!=document.getElementById("ckHcutOff")&&(document.getElementById("ckHcutOff").checked=l.ishcutoff);null!=document.getElementById("ckHcutColor")&&(document.getElementById("ckHcutColor").checked=l.ishcutcolor);null!=document.getElementById("ckHcutOff")&&null!=document.getElementById("ckHcutColor")&&u(document.getElementById("ckHcutOff"),document.getElementById("ckHcutColor"));null!=document.getElementById("ckHcutColor")&&null!=document.getElementById("ckHcutOff")&&u(document.getElementById("ckHcutColor"),document.getElementById("ckHcutOff"));null!=document.getElementById("pickerColor")&&(document.getElementById("pickerColor").value=l.color);null!=document.getElementById("ckEndOff")&&(document.getElementById("ckEndOff").checked=l.isendoff);null!=document.getElementById("ckEndColor")&&(document.getElementById("ckEndColor").checked=l.isendcolor);null!=document.getElementById("ckEndOff")&&null!=document.getElementById("ckEndColor")&&u(document.getElementById("ckEndOff"),document.getElementById("ckEndColor"));null!=document.getElementById("ckEndColor")&&null!=document.getElementById("ckEndOff")&&u(document.getElementById("ckEndColor"),document.getElementById("ckEndOff"))}(this.responseText)},e.onerror=function(){c("PARAMETER READ ERROR : CONNECTION LOST","red")},e.overrideMimeType("application/json"),e.open("GET",t+"/parameterRead",!0),e.send(null)}function y(){var e=new XMLHttpRequest;e.onload=function(){200==this.status?c(this.responseText,"green"):c(this.responseText,"red"),g()},e.onerror=function(){c("PARAMETER WRITE ERROR : CONNECTION LOST","red")},e.open("POST",t+"/parameterWrite",!0),e.setRequestHeader("Content-type","application/json"),e.send(function(){null!=document.getElementById("sliderDelay")&&(l.delay=document.getElementById("sliderDelay").value);null!=document.getElementById("sliderBrightness")&&(l.brightness=document.getElementById("sliderBrightness").value);null!=document.getElementById("sliderCountdown")&&(l.countdown=document.getElementById("sliderCountdown").value);null!=document.getElementById("ckCountdown")&&(l.iscountdown=document.getElementById("ckCountdown").checked);null!=document.getElementById("sliderRepeat")&&(l.repeat=document.getElementById("sliderRepeat").value);null!=document.getElementById("ckInvert")&&(l.isinvert=document.getElementById("ckInvert").checked);null!=document.getElementById("ckRepeat")&&(l.isrepeat=document.getElementById("ckRepeat").checked);null!=document.getElementById("ckBounce")&&(l.isbounce=document.getElementById("ckBounce").checked);null!=document.getElementById("sliderVcut")&&(l.vcut=document.getElementById("sliderVcut").value);null!=document.getElementById("ckVcutOff")&&(l.isvcutoff=document.getElementById("ckVcutOff").checked);null!=document.getElementById("ckVcutColor")&&(l.isvcutcolor=document.getElementById("ckVcutColor").checked);null!=document.getElementById("sliderHcut")&&(l.hcut=document.getElementById("sliderHcut").value);null!=document.getElementById("ckHcutOff")&&(l.ishcutoff=document.getElementById("ckHcutOff").checked);null!=document.getElementById("ckHcutColor")&&(l.ishcutcolor=document.getElementById("ckHcutColor").checked);null!=document.getElementById("pickerColor")&&(l.color=document.getElementById("pickerColor").value);null!=document.getElementById("ckEndOff")&&(l.isendoff=document.getElementById("ckEndOff").checked);null!=document.getElementById("ckEndColor")&&(l.isendcolor=document.getElementById("ckEndColor").checked);return JSON.stringify(l)}())}function B(){var e=new XMLHttpRequest;e.onload=function(){200==this.status&&function(e){o=JSON.parse(e),null!=document.getElementById("sliderConvertPixels")&&(document.getElementById("sliderConvertPixels").setAttribute("max",o.numPixels),document.getElementById("sliderConvertPixels").value=o.numPixels);null!=document.getElementById("textConvertPixels")&&(document.getElementById("textConvertPixels").innerHTML=o.numPixels+"px");null!=document.getElementById("sliderGeneratePixels")&&(document.getElementById("sliderGeneratePixels").setAttribute("max",o.numPixels),document.getElementById("sliderGeneratePixels").value=o.numPixels);null!=document.getElementById("textGeneratePixels")&&(document.getElementById("textGeneratePixels").innerHTML=o.numPixels+"px");null!=document.getElementById("textSystemPixels")&&(document.getElementById("textSystemPixels").innerHTML=o.numPixels+"px");if(null!=document.getElementById("canvasSystem")){new PieChart({canvas:document.getElementById("canvasSystem"),data:{Used:o.usedBytes,Free:o.freeBytes},colors:["red","green"]}).draw()}}(this.responseText)},e.onerror=function(){c("SYSTEM READ ERROR : CONNECTION LOST","red")},e.overrideMimeType("application/json"),e.open("GET",t+"/systemRead",!0),e.send(null)}function I(){var e=new XMLHttpRequest;e.onload=function(){200==this.status&&function(e){if(n=JSON.parse(e),null!=document.getElementById("selectAction")){document.getElementById("selectAction").options.length=n.fileList.length;for(var t=0;t<n.fileList.length;t++)document.getElementById("selectAction").options[t].value=n.fileList[t],document.getElementById("selectAction").options[t].text=n.fileList[t]}}(this.responseText)},e.onerror=function(){c("LIST ERROR : CONNECTION LOST","red")},e.overrideMimeType("application/json"),e.open("GET",t+"/list",!0),e.send(null)}if(e.target.matches("#actions")){document.getElementById("btnStatus").addEventListener("click",(function(){document.getElementById("popoverStatus").show(document.getElementById("btnStatus"))}),!1);var v=new Image,f=document.getElementById("selectAction"),p=document.getElementById("canvasAction"),L=document.getElementById("btnActionDelete"),k=document.getElementById("btnActionDownload"),x=document.getElementById("sliderActionStart"),h=document.getElementById("textActionStart"),A=document.getElementById("sliderActionStop"),b=document.getElementById("textActionStop"),C=document.getElementById("sliderActionLength"),S=document.getElementById("textActionLength"),T=document.getElementById("btnActionLight"),O=document.getElementById("btnActionBurn"),R=document.getElementById("btnActionStop"),H=document.getElementById("btnActionPlay");f.addEventListener("change",E,!1),v.addEventListener("load",(function(){drawAction(v,p,x.value,A.value)}),!1),L.addEventListener("click",(function(){var e,n;e=f.value,(n=new XMLHttpRequest).onload=function(){200==this.status?c(this.responseText,"green"):c(this.responseText,"red"),B(),I(),s()},n.onerror=function(){c("DELETE ERROR : CONNECTION LOST","red")},n.open("DELETE",t+"/delete",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(e)}),!1),k.addEventListener("click",(function(){m(t+"/"+f.value,f.value.substring(1))}),!1),x.addEventListener("input",(function(){A.value=Math.max(x.value,A.value),h.innerHTML=x.value+"px",b.innerHTML=A.value+"px",C.setAttribute("max",255*(A.value-x.value)),C.value=(A.value-x.value)*l.delay,S.innerHTML=C.value+"ms",drawAction(v,p,x.value,A.value)}),!1),x.addEventListener("change",E,!1),A.addEventListener("input",(function(){x.value=Math.min(x.value,A.value),h.innerHTML=x.value+"px",b.innerHTML=A.value+"px",C.setAttribute("max",255*(A.value-x.value)),C.value=(A.value-x.value)*l.delay,S.innerHTML=C.value+"ms",drawAction(v,p,x.value,A.value)}),!1),A.addEventListener("change",E,!1),C.addEventListener("input",(function(){S.innerHTML=C.value+"ms",l.delay=C.value/(A.value-x.value)}),!1),C.addEventListener("change",y,!1),T.addEventListener("click",(function(){a("/light")}),!1),O.addEventListener("click",(function(){a("/burn")}),!1),R.addEventListener("click",(function(){a("/stop")}),!1),H.addEventListener("click",(function(){a("/play")}),!1),I(),g(),s()}if(e.target.matches("#settings")){document.getElementById("btnStatus").addEventListener("click",(function(){document.getElementById("popoverStatus").show(document.getElementById("btnStatus"))}),!1);var w=document.getElementById("sliderDelay"),M=document.getElementById("textDelay"),P=document.getElementById("sliderBrightness"),N=document.getElementById("textBrightness"),D=document.getElementById("sliderCountdown"),V=document.getElementById("textCountdown"),G=document.getElementById("sliderRepeat"),q=document.getElementById("textRepeat"),U=document.getElementById("sliderVcut"),X=document.getElementById("textVcut"),j=document.getElementById("sliderHcut"),J=document.getElementById("textHcut"),F=document.getElementById("pickerColor"),W=document.getElementById("ckCountdown"),z=document.getElementById("ckInvert"),Y=document.getElementById("ckRepeat"),$=document.getElementById("ckBounce"),K=document.getElementById("ckVcutOff"),Q=document.getElementById("ckVcutColor"),Z=document.getElementById("ckHcutOff"),_=document.getElementById("ckHcutColor"),ee=document.getElementById("ckEndOff"),te=document.getElementById("ckEndColor"),ne=document.getElementById("btnSave"),de=document.getElementById("btnRestore");w.addEventListener("input",(function(){M.innerHTML=w.value+"ms"}),!1),P.addEventListener("input",(function(){N.innerHTML=P.value+"%"}),!1),D.addEventListener("input",(function(){V.innerHTML=D.value+"ms"}),!1),G.addEventListener("input",(function(){q.innerHTML=G.value+"x"}),!1),U.addEventListener("input",(function(){X.innerHTML=U.value+"px"}),!1),j.addEventListener("input",(function(){J.innerHTML=j.value+"px"}),!1),w.addEventListener("change",y,!1),P.addEventListener("change",y,!1),D.addEventListener("change",y,!1),G.addEventListener("change",y,!1),U.addEventListener("change",y,!1),j.addEventListener("change",y,!1),F.addEventListener("change",y,!1),Y.addEventListener("click",(function(){u(Y,$)}),!1),$.addEventListener("click",(function(){u($,Y)}),!1),K.addEventListener("click",(function(){u(K,Q)}),!1),Q.addEventListener("click",(function(){u(Q,K)}),!1),Z.addEventListener("click",(function(){u(Z,_)}),!1),_.addEventListener("click",(function(){u(_,Z)}),!1),te.addEventListener("click",(function(){u(te,ee)}),!1),ee.addEventListener("click",(function(){u(ee,te)}),!1),W.addEventListener("click",y,!1),z.addEventListener("click",y,!1),Y.addEventListener("click",y,!1),$.addEventListener("click",y,!1),K.addEventListener("click",y,!1),Q.addEventListener("click",y,!1),Z.addEventListener("click",y,!1),_.addEventListener("click",y,!1),te.addEventListener("click",y,!1),ee.addEventListener("click",y,!1),ne.addEventListener("click",(function(){var e=new XMLHttpRequest;e.onload=function(){200==this.status?c(this.responseText,"green"):c(this.responseText,"red")},e.onerror=function(){c("PARAMETER SAVE ERROR : CONNECTION LOST","red")},e.open("GET",t+"/parameterSave",!0),e.send(null)}),!1),de.addEventListener("click",(function(){var e=new XMLHttpRequest;e.onload=function(){200==this.status?c(this.responseText,"green"):c(this.responseText,"red"),g()},e.onerror=function(){c("PARAMETER RESTORE ERROR : CONNECTION LOST","red")},e.open("GET",t+"/parameterRestore",!0),e.send(null)}),!1),g()}if(e.target.matches("#convert")){document.getElementById("btnStatus").addEventListener("click",(function(){document.getElementById("popoverStatus").show(document.getElementById("btnStatus"))}),!1);var le=new Image,oe=document.getElementById("canvasConvert"),ce=document.getElementById("selectConvert"),ue=document.getElementById("selectConvertGamma"),ie=document.getElementById("selectConvertOrientation"),me=document.getElementById("sliderConvertPixels"),re=document.getElementById("textConvertPixels"),ae=document.getElementById("btnConvertOriginal"),se=document.getElementById("btnConvertUpload"),Ee=document.getElementById("btnConvertDownload");function ge(){if(0==ce.files.length)return drawError("No File",oe),ue.setAttribute("disabled",""),ie.setAttribute("disabled",""),me.setAttribute("disabled",""),ae.setAttribute("disabled",""),se.setAttribute("disabled",""),void Ee.setAttribute("disabled","");var e,t=ce.files[0];if(/^image\//.test(t.type)){le.file=t;var n=new FileReader;n.onload=(e=le,function(t){e.src=t.target.result}),n.readAsDataURL(t),ue.removeAttribute("disabled",""),ie.removeAttribute("disabled",""),me.removeAttribute("disabled",""),ae.removeAttribute("disabled",""),se.removeAttribute("disabled",""),Ee.removeAttribute("disabled","")}else drawError("No Convert",oe),ue.setAttribute("disabled",""),ie.setAttribute("disabled",""),me.setAttribute("disabled",""),ae.removeAttribute("disabled",""),se.setAttribute("disabled",""),Ee.setAttribute("disabled","")}ce.addEventListener("change",ge,!1),le.addEventListener("load",(function(){drawConvert(le,oe,ie.value,ue.value,me.value,me.getAttribute("max"))}),!1),ue.addEventListener("change",(function(){drawConvert(le,oe,ie.value,ue.value,me.value,me.getAttribute("max"))}),!1),ie.addEventListener("change",(function(){drawConvert(le,oe,ie.value,ue.value,me.value,me.getAttribute("max"))}),!1),me.addEventListener("input",(function(){re.innerHTML=me.value+"px"}),!1),me.addEventListener("change",(function(){drawConvert(le,oe,ie.value,ue.value,me.value,me.getAttribute("max"))}),!1),ae.addEventListener("click",(function(){r(ce.files[0],i(ce.files[0].name,""))}),!1),se.addEventListener("click",(function(){r(CanvasToBMP.toBlob(oe),i(ce.files[0].name,"bmp"))}),!1),Ee.addEventListener("click",(function(){m(CanvasToBMP.toDataURL(oe),i(ce.files[0].name,"bmp"))}),!1),B(),ge()}if(e.target.matches("#generate")){document.getElementById("btnStatus").addEventListener("click",(function(){document.getElementById("popoverStatus").show(document.getElementById("btnStatus"))}),!1);var ye=document.createElement("canvas"),Be=document.getElementById("canvasGenerate"),Ie=document.getElementById("selectGenerate"),ve=document.getElementById("selectGenerateGamma"),fe=document.getElementById("selectGenerateOrientation"),pe=document.getElementById("sliderGeneratePixels"),Le=document.getElementById("textGeneratePixels"),ke=document.getElementById("btnGenerateRefresh"),xe=document.getElementById("btnGenerateUpload"),he=document.getElementById("btnGenerateDownload");Ie.addEventListener("change",(function(){generate(ye,Ie.value),drawConvert(ye,Be,fe.value,ve.value,pe.value,pe.getAttribute("max"))}),!1),ve.addEventListener("change",(function(){drawConvert(ye,Be,fe.value,ve.value,pe.value,pe.getAttribute("max"))}),!1),fe.addEventListener("change",(function(){drawConvert(ye,Be,fe.value,ve.value,pe.value,pe.getAttribute("max"))}),!1),pe.addEventListener("input",(function(){Le.innerHTML=pe.value+"px"}),!1),pe.addEventListener("change",(function(){drawConvert(ye,Be,fe.value,ve.value,pe.value,pe.getAttribute("max"))}),!1),ke.addEventListener("click",(function(){generate(ye,Ie.value),drawConvert(ye,Be,fe.value,ve.value,pe.value,pe.getAttribute("max"))}),!1),he.addEventListener("click",(function(){m(CanvasToBMP.toDataURL(Be),Ie.value+".bmp")}),!1),xe.addEventListener("click",(function(){r(CanvasToBMP.toBlob(Be),Ie.value+".bmp")}),!1),B(),setTimeout((function(){generate(ye,Ie.value),drawConvert(ye,Be,fe.value,ve.value,pe.value,pe.getAttribute("max"))}),500)}e.target.matches("#system")&&(document.getElementById("btnStatus").addEventListener("click",(function(){document.getElementById("popoverStatus").show(document.getElementById("btnStatus"))}),!1),B())}),!1);
